(()=>{"use strict";var t,e={task:{title:"",details:"",date:"",priority:"",checked:""},project:{title:"",id:"",tasks:[]},projects:[{title:"All Tasks",id:"allTasks",tasks:[],flag:"home"},{title:"Today",id:"today",flag:"home",tasks:[]},{title:"Next 7 Days",id:"week",flag:"home",tasks:[]}]};function n(){e.projects[o("allTasks")].tasks=e.projects.filter((function(t){return"home"!==t.flag})).flatMap((function(t){return t.tasks})),e.projects[o("today")].tasks=e.projects[o("allTasks")].tasks.filter((function(t){return t.date===(new Date).toISOString().split("T")[0]})),e.projects[o("week")].tasks=e.projects[o("allTasks")].tasks.filter((function(t){return t.date<=new Date((new Date).setDate((new Date).getDate()+7)).toISOString().split("T")[0]&&t.date>=(new Date).toISOString().split("T")[0]})),i()}function i(){localStorage.setItem("projects",JSON.stringify(e.projects))}function o(t){return e.projects.findIndex((function(e){return e.id===t}))}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===r(o)?o:String(o)),i)}var o}(t=localStorage.getItem("projects"))&&(e.projects=JSON.parse(t));var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"_closeForm",value:function(){this._addHidden(".formAdd"),this._clearInput()}},{key:"_openForm",value:function(){this._removeHidden(".formAdd"),this._parentEl.querySelector(".input").focus()}},{key:"_clearInput",value:function(){this._parentEl.querySelectorAll(".input").forEach((function(t){t.value=""}))}},{key:"_addHidden",value:function(t){var e;return null===(e=this._parentEl.querySelector(t))||void 0===e?void 0:e.classList.add("hidden")}},{key:"_removeHidden",value:function(t){var e;return null===(e=this._parentEl.querySelector(t))||void 0===e?void 0:e.classList.remove("hidden")}},{key:"_dropdown",value:function(){document.addEventListener("click",(function(t){var e=t.target.closest(".edit");e?(document.querySelectorAll(".edit__options").forEach((function(t){t.classList.add("hidden")})),e.querySelector(".edit__options").classList.toggle("hidden")):document.querySelectorAll(".edit__options").forEach((function(t){t.classList.add("hidden")}))}))}},{key:"_openEdit",value:function(t){this.moveFormEdit();var e=t.target.closest("li"),n=this._parentEl.querySelector(".formEdit");n.classList.remove("hidden"),e.classList.add("hidden"),this._container.appendChild(n),this._container.insertBefore(n,e),this._selected=e.id}},{key:"render",value:function(t){this._data=t;var e=this._generateMarkup();this._container.insertAdjacentHTML("beforeend",e)}},{key:"addHandler",value:function(t){this._parentEl.addEventListener("click",function(e){e.target.classList.contains("form-btn__add")&&(t(),this._closeForm())}.bind(this))}},{key:"moveFormEdit",value:function(){this._removeHidden("li.hidden"),this._addHidden(".formEdit"),this._parentEl.appendChild(this._parentEl.querySelector(".formEdit"))}},{key:"addHandlerEdit",value:function(t){this._parentEl.addEventListener("click",function(e){e.target.classList.contains("form-btn__edit")&&(t(),this.moveFormEdit(),this._closeForm())}.bind(this))}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_(i.key),i)}}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e,n){return(e=_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===s(e)?e:String(e)}const h=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(a,t);var e,n,i,o,r=(i=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(i);if(o){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),p(u(t=r.call(this)),"_data",void 0),p(u(t),"_parentEl",document.querySelector(".side-bar")),p(u(t),"_container",t._parentEl.querySelector(".projects")),p(u(t),"_selected",void 0),t._parentEl.querySelector(".form-btn__cancel").addEventListener("click",function(){this._closeForm(),this.moveFormEdit()}.bind(u(t))),t._parentEl.querySelector(".btn-open-form").addEventListener("click",function(){this._openForm(),this.moveFormEdit()}.bind(u(t))),t._parentEl.addEventListener("click",function(t){t.target.classList.contains("edit__change")&&(this._openEdit(t),this._closeForm())}.bind(u(t))),t._selectProject(),t._dropdown(),t._toggleSideBar(),t}return e=a,(n=[{key:"_toggleSideBar",value:function(){document.querySelector(".hide-side-bar").addEventListener("click",function(){this._parentEl.classList.toggle("hidden")}.bind(this))}},{key:"getProjectData",value:function(){return[this._parentEl.querySelector(".side-bar__input").value,this._selected]}},{key:"addHandlerRemoveProject",value:function(t){this._parentEl.addEventListener("click",function(e){if(e.target.classList.contains("edit__delete")){var n=e.target.closest("li");t(n.id),n.remove()}}.bind(this))}},{key:"renderAllProjects",value:function(t){this._data=t;var e=this._generateMarkupAll();this._container.innerHTML=e}},{key:"updateProject",value:function(t){this._data=t,window.location.hash.slice(1)===this._data.id&&(document.querySelector("h1").textContent=this._data.title);var e=this._generateMarkup(),n=document.createRange().createContextualFragment(e).querySelector(".side-bar__item-link"),i=document.getElementById(this._selected).querySelector(".side-bar__item-link");n.isEqualNode(i)||(i.textContent=n.textContent)}},{key:"_selectProject",value:function(){this._parentEl.addEventListener("click",function(t){t.target.classList.contains("side-bar__item-link")&&(this._parentEl.querySelectorAll(".side-bar__item").forEach((function(t){t.classList.contains("selected")&&t.classList.remove("selected")})),t.target.closest(".side-bar__item").classList.add("selected"))}.bind(this))}},{key:"_generateMarkupAll",value:function(){return this._data.map((function(t){if("home"!==t.flag)return'\n            <li class="side-bar__item" id="'.concat(t.id,'">\n                <a class="side-bar__item-link" href="#').concat(t.id,'">').concat(t.title,'</a>\n                <div class="edit">\n                    <div class="edit__options hidden">\n                        <button class="edit__delete">Delete</button>\n                        <button class="edit__change">Rename</button>\n                    </div>\n                    <button class="edit__open"><img src="img/dots.svg" alt="More button"></button>\n                </div>\n            </li>')})).join("")}},{key:"_generateMarkup",value:function(){return'\n        <li class="side-bar__item" id="'.concat(this._data.id,'">\n            <a class="side-bar__item-link" href="#').concat(this._data.id,'">').concat(this._data.title,'</a>\n            <div class="edit">\n                <div class="edit__options hidden">\n                    <button class="edit__delete">Delete</button>\n                    <button class="edit__change">Rename</button>\n                </div>\n                <button class="edit__open"><img src="img/dots.svg" alt="More button"></button>\n            </div>\n        </li>')}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(c));function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,j(i.key),i)}}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}function g(t,e,n){return(e=j(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j(t){var e=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==y(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===y(e)?e:String(e)}const E=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}(a,t);var e,n,i,o,r=(i=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(i);if(o){var n=k(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return b(t)}(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),g(b(t=r.call(this)),"_data",void 0),g(b(t),"_parentEl",document.querySelector(".content")),g(b(t),"_container",t._parentEl.querySelector(".todo-list")),g(b(t),"_selected",void 0),g(b(t),"_id",0),g(b(t),"clicked",void 0),document.querySelector(".side-bar").addEventListener("click",t.moveFormEdit.bind(b(t))),t._parentEl.addEventListener("click",function(t){t.target.classList.contains("form-btn__cancel")&&(this._closeForm(),this.moveFormEdit()),t.target.classList.contains("btn-open-form")&&(this._openForm(),this.moveFormEdit()),t.target.classList.contains("edit__change")&&(this._openEdit(t),this._closeForm())}.bind(b(t))),t}return e=a,(n=[{key:"addHandlerFinishTask",value:function(t){document.addEventListener("click",function(e){if(e.target.classList.contains("todo__complete")){var n=e.target.closest(".todo");n.querySelector(".todo__text").classList.toggle("checked"),this.clicked=n.id,t()}}.bind(this))}},{key:"renderEmpty",value:function(){this._addHidden(".btn-open-form"),this._container.innerHTML="",this._parentEl.querySelector("h1").textContent="NO DATA"}},{key:"renderAllTasks",value:function(t){this._data=t;var e=this._generateMarkupAll();this._parentEl.querySelector("h1").textContent=t.title,this._container.innerHTML=e,this._removeHidden(".btn-open-form"),"allTasks"!==this._data.id&&"today"!==this._data.id&&"week"!==this._data.id||this._addHidden(".btn-open-form")}},{key:"addHandlerRemoveTask",value:function(t){this._parentEl.addEventListener("click",function(e){if(e.target.classList.contains("edit__delete")){var n=e.target.closest(".todo");t(n.dataset.projectId,n.id),n.remove(),this._parentEl.querySelectorAll(".todo").forEach((function(t){t.id>n.id&&(t.id-=1)}))}}.bind(this))}},{key:"loadTasksHandler",value:function(t){window.addEventListener("hashchange",(function(){t()}))}},{key:"updateTask",value:function(t){this._data=t;var e=this._generateMarkup();this._id&&this._id--;var n=document.createRange().createContextualFragment(e);n.querySelector("li").id=this._selected;var i=Array.from(n.querySelector("li").querySelectorAll("*")),o=Array.from(document.getElementById(this._selected).querySelectorAll("*"));o[0].closest("li").classList.replace(o[0].closest("li").className.split(" ")[1],i[0].closest("li").className.split(" ")[1]),i.forEach((function(t,e){var n,i=o[e];t.isEqualNode(i)||""===(null===(n=t.firstChild)||void 0===n?void 0:n.nodeValue.trim())||(i.textContent=t.textContent)}))}},{key:"getTask",value:function(){var t=this,e=["title","details","date","priority"].map((function(e){return t._parentEl.querySelector(".todo-form__".concat(e)).value}));return e.push(this._selected),e.push(window.location.hash.slice(1)),e}},{key:"_generateMarkupAll",value:function(){return this._id=this._data.tasks.length,this._data.tasks.map((function(t,e){return'\n            <li class="todo priority-'.concat("2"===t.priority?"high":"1"===t.priority?"medium":"low",'" id="').concat(e,'" data-project-id="').concat(t.projectId,'">\n                <label>\n                    <input class="todo__complete" type="checkbox" ').concat(t.checked?"checked":"",'>\n                </label>\n                <div class="todo__text ').concat(t.checked?"checked":"",'">\n                    <h3 class="todo__title">').concat(t.title,'</h3>\n                    <p class="todo__details">').concat(t.details,'</p>\n                </div>\n                <time class="todo__date">').concat(t.date,'</time>\n                <div class="edit">\n                    <div class="edit__options hidden">\n                        <button class="edit__delete">Delete</button>\n                        <button class="edit__change">Edit</button>\n                    </div>\n                    <button class="edit__open"><img src="img/dots.svg" alt="More button"></button>\n                </div>\n            </li>\n            ')})).join("")}},{key:"_generateMarkup",value:function(){var t='\n        <li class="todo priority-'.concat("2"===this._data.priority?"high":"1"===this._data.priority?"medium":"low",'" id="').concat(this._id,'" data-project-id="').concat(this._data.projectId,'">\n            <label>\n                <input class="todo__complete" type="checkbox">\n            </label>\n            <div class="todo__text ').concat(this._data.checked?"checked":"",'">\n                <h3 class="todo__title">').concat(this._data.title,'</h3>\n                <p class="todo__details">').concat(this._data.details,'</p>\n            </div>\n            <time class="todo__date">').concat(this._data.date,'</time>\n            <div class="edit">\n                <div class="edit__options hidden">\n                    <button class="edit__delete">Delete</button>\n                    <button class="edit__change">Edit</button>\n                </div>\n                <button class="edit__open"><img src="img/dots.svg" alt="More button"></button>\n            </div>\n        </li>\n        ');return this._id++,t}}])&&v(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(c));!function(){window.location.hash="#allTasks";var t=e.projects.find((function(t){return t.id===window.location.hash.slice(1)}));n(),h.renderAllProjects(e.projects),E.renderAllTasks(t)}(),h.addHandler((function(){var t=h.getProjectData();t[0].trim()&&(function(t){e.project={title:t,id:Date.now().toString(),tasks:[]};var n=Object.assign({},e.project);e.projects.push(n),i()}(t[0]),h.render(e.project))})),h.addHandlerRemoveProject((function(t){E.moveFormEdit(),function(t){e.projects.splice(o(t),1),i()}(t),n();var r=e.projects.find((function(t){return t.id===window.location.hash.slice(1)}));t===window.location.hash.slice(1)?E.renderEmpty():E.renderAllTasks(r)})),h.addHandlerEdit((function(){var t,n;t=h.getProjectData(),(n=e.projects.find((function(e){return e.id===t[1]}))).title=t[0],e.project=n,i(),h.updateProject(e.project)})),E.addHandler((function(){e.projects.find((function(t){return t.id===window.location.hash.slice(1)})),function(t){e.task={title:t[0],details:t[1],date:t[2],priority:t[3],projectId:t[5],checked:!1};var n=Object.assign({},e.task);e.projects.find((function(t){return t.id===window.location.hash.slice(1)})).tasks.push(n),i()}(E.getTask()),E.render(e.task),n()})),E.loadTasksHandler((function(){var t=e.projects.find((function(t){return t.id===window.location.hash.slice(1)}));E.renderAllTasks(t)})),E.addHandlerFinishTask((function(){var t,n;t=E.clicked,(n=e.projects.find((function(t){return t.id===window.location.hash.slice(1)})).tasks.find((function(e,n){return n==t}))).checked=!n.checked,i()})),E.addHandlerEdit((function(){var t,o;t=E.getTask(),(o=e.projects.find((function(t){return t.id===window.location.hash.slice(1)})).tasks.find((function(e,n){return n==t[4]}))).title=t[0],o.details=t[1],o.date=t[2],o.priority=t[3],e.task=o,i(),e.projects.find((function(t){return t.id===window.location.hash.slice(1)})),E.updateTask(e.task),n()})),E.addHandlerRemoveTask((function(t,o){!function(t,n){e.projects.find((function(e){return e.id===t})).tasks.splice(n,1),i()}(t,o),n()}))})();
//# sourceMappingURL=main.js.map